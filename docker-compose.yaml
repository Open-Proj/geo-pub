services:
  postgres:
    image: postgis/postgis:18-3.6-alpine
    volumes:
      - pgdata:/var/lib/postgresql
    ports:
      - 5432:5432
    environment:
      - POSTGRES_USER=geo-pub-dev
      - POSTGRES_PASSWORD=geo-pub-dev
      - POSTGRES_DB=geo_pub_dev

  geopub:
    build:
      context: ./geopub
      dockerfile: dev.Dockerfile
    ports:
      - 8000:8000
    volumes:
      - ./geopub:/app
    environment:
      - NODE_ENV=development
      - DATABASE_URL=postgresql://geo-pub-dev:geo-pub-dev@postgres:5432/geo_pub_dev
    depends_on:
      - postgres

  frontend:
    build:
      context: ./frontend
      dockerfile: dev.Dockerfile
    ports:
      - 5173:5173
    volumes:
      - ./frontend:/app
    environment:
      - NODE_ENV=development

volumes:
  pgdata: {}
